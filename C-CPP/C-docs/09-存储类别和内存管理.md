# 1. 存储类别

## 1.1 存储类别

数据被存储在内存中，从硬件来看，被存储的被一个值都占用一定的物理内存。C 语言把这样的一块内存称为对象。对象可以存储一个或多个值，一个对象可能未存储实际的值，但是它在存储适当的值时一定具有相应的大小。（面向对象编程语言中的对象指的是类对象，其定义包括数据和允许对数据的操作，C 语言不是面向对象编程语言）

可以使用存储期(Storage Duration)来描述对象，所谓存储期是指对象在内存中保留了多长时间。标识符用于访问对象，可以用作用域(scope)和链接(linkage)描述标识符，标识符的作用域和链接表明了程序哪些部分可以使用它。不同的存储类别有不同的存储期、作用域和链接。

标识符可以在源代码的多个文件中共享、可用于特定文件的任意函数中、可仅限于特定函数中使用，甚至只在函数的某个部分使用。对象可存在于程序的执行期，也可以仅存在于它所在的函数的执行期。

对于并发编程，对象可以在特定线程的执行期存在，可以通过函数调用的方式显式分配和释放内存。

C 语言预处理器实际上是用包含的头文件内容替换 `#include` 指令。所以，编译器把源代码文件和所有的头文件看做是一个包含信息的单独文件。这个文件被称为翻译单元(translation unit)。描述一个具有文件作用域的变量时，它的实际可见范围是整个翻译单元。如果程序由多个源代码文件组成，那么该程序也将有多个翻译单元组成，每个翻译单元均对象一个源代码文件和它包含的文件。

## 1.2 链接

C 变量有三种链接属性：外部链接，内部链接，无链接。

无链接变量是指具有块作用域、函数作用域或函数原型作用域的变量，意味着这些变量属于定义他们的块、函数或原型私有。

具有文件作用域的变量可以是外部链接或内部链接。外部链接变量可以在多文件程序中使用，简称为全局作用域。内部链接变量只能在一个翻译单元使用，成为文件作用域。

## 1.3 存储期

C 对象有 4 种存储器：静态存储期，线程存储期，自动存储期，动态分配存储期。

静态存储器在程序的执行期间一直存储。文件作用域变量具有静态存储期。对于文件作用域变量，关键字 static 表明了其链接属性，而非存储期。以 static 声明的文件作用域具有内部链接。但是无论是内部链接或外部链接，所有的文件作用域变量都具有静态存储期。

线程存储期用于并发程序设计，程序执行可被分为多个线程。具有线程存储期的对象，从被声明时到线程结束一直存在。以关键字 `_Thread_local` 声明一个对象时，每一个线程都将获得该变量私有备份。

块作用域的变量有自动存储期，进入块作用域，为这些变量分配内存。退出这个块时，释放内存。





























