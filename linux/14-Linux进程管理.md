# Linux进程管理
### 进程管理简介
+ 进程是正在执行的一个程序或命令,每一个进程都是一个运行的实体,都有自己的地址空间,并占用一定的系统资源.
+ 进程管理的作用
    + 判断服务器健康状态(主要)
    + 查看系统中所有进程(次要)
    + 杀死进程(再次要)

### 进程的查看`-ps`命令和`pstree`命令
##### `-ps命令`
+ `ps aux` 查看系统中所有进程,使用`BSD操作系统`格式
+ `ps -le` 查看系统中所有进程,使用`Linux标准命令`格式
+ `a`:显示一个终端的所有进程,处理会话引线
+ `u`:显示进程的归属用户及内存的使用情况
+ `x`:显示没有控制终端的进程
+ `-l`:长格式显示.显示更加详细的信息
+ `-e`:显示所有的进程,和`-A`作用一致

|USER |PID  |CPU  |MEN  |VSZ  |RSS  |TTY  |STAT |START|TIME |COMMAND|
|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-------|
|     |     |     |     |     |     |     |     |     |     |       |

+ `USER`:该进程由哪个用户产生的
+ `PID`:进程的ID号
+ `%CPU`:该进程占用CPU资源的百分比,占用越高,进程约耗费资源
+ `%MEM`:该进程占用物理内存的百分比,占用越高,进程越耗费资源
+ `VSZ`:该进程占用虚拟内存的大小,单位为kb
+ `RSS`:该进程占用实际物理内存的发小,单位为kb
+ `TTY`:该进程是在哪个终端中进行的.
    + `?`:代表是系统自己启动的
    + `ttys-tty7`:代表本地控制台终端
    + `tty1-tty6`:是本地字符界面终端
    + `tty7`:是图形终端
    + `pts/0-255`:代表虚拟终端
+ `STAT`进程的状态,常见的状态有
    + `S`:休眠状态
    + `R`:运行状态
    + `T`:停止状态
    + `s`:包含子进程
    + `+`:位于后台
+ `START`:该进程的启动时间
+ `TIME`:该进程占用CPU的运算时间,注意不是系统时间
+ `COMMAND`:产生此进程的命令名

##### `pstree命令`
+ `pstree`:显示进程树
+ `-p`:查看每个进程及进程号
+ `-u`:查看每个进程的用户是谁

### 进程的查看`-top`命令
##### top命令以及选项
+ `top [选项]`
+ `-d 秒数`:指定top明理路每隔几秒更新，默认是3秒
+ `-n 次数`:指定top命令执行的次数。一般和`-b`选项合用
+ `top -b -n 1 > top.log`把所有进程信息写入一个日志文件
+ 在top命令的交互模式当中可以执行的命令:
    + `?或h`:显示交互模式的帮助
    + `P`:以CPU使用率排序，默认是此项
    + `M`:以内存的使用率排序
    + `N`:以PID排序
    + `q`:退出top

### top命令顶部的五行的信息
##### `top`:任务队列信息,平均负载是一个经验值,并不能简单用CPU核数来看。
+ `top - 05:50:18 up  2:35,  2 users,  load average: 0.00, 0.00, 0.00`
+ `top`:指top行
+ `05:50:18`:当前时间
+ `up  2:35`:系统的运行时间
+ `2 users`:当前登录了两个用户
+ **`load average: 0.00, 0.00, 0.00`:平均负载，5分钟前，10分钟前，15分钟前**

##### `Tasks`:进程信息
+ `Tasks: 135 total,   2 running, 133 sleeping,   0 stopped,   0 zombie`
+ `Tasks`:指Tasks行
+ `135 total`:系统中的进程总数
+ `2 running`:正在运行的进程数
+ `133 sleeping`:睡眠的进程数
+ `0 stopped`:正在停止的进程数
+ `0 zombie`:僵尸进程。如果不是0，需要手工检查僵尸进程

##### `CPU(s)`:CPU信息,最重要的是id 空闲百分比不能低于20%,也就是CPU的占用率不能高于20%
+ `Cpu(s):  0.6%us,  1.3%sy,  0.0%ni, 97.6%id,  0.0%wa,  0.1%hi,  0.5%si,  0.0%st`
+ `Cpu(s)`:指CPU行
+ `0.6%us`:用户模式占用的CPU百分比
+ `1.3%sy`:系统模式占用的CPU百分比
+ `0.0%ni`:改变过优先级的用户进程占用的CPU百分比
+ **`97.6%id`:空闲的CPU百分比**
+ `0.0%wa`:等待输入/输出的进程的占用CPU百分比
+ `0.1%hi`:硬中断请求服务占用的CPU百分比
+ `0.5%si`:软中断请求服务占用的CPU百分比
+ `0.0%st`:(Steal Time)虚拟时间百分比，就是当有虚拟时间时，虚拟CPU等待实际CPU的时间百分比

##### `Mem`:物理内存信息,缓冲加速了数据的写入。
+ `Mem:   1004412k total,   779236k used,   225176k free,    31304k buffers`
+ `Mem`:指Mem行
+ `1004412k total`:物理内存的总量，单位KB
+ `779236k used`:已经使用的物理内存数量
+ **`225176k free`:空闲的物理内存数量**
+ `31304k buffers`:作为缓冲的内存数量

##### `Swap`:交换分区(swap)信息,缓存加速了数据的读取
+ `Swap:  2031608k total,     7400k used,  2024208k free,   375536k cached`
+ `2031608k total`:交换分区的总大小
+ `7400k used`:已经使用的交换分区的大小
+ **`2024208k free`:空闲交换分区的大小**
+ `375536k cached`:作为缓冲的交换分区的大小

### 杀死进程
##### kill
+ 如果正确关闭进程方式不能使用,再使用杀死进程方式,否则不能使用
+ `kill -l`查看可用的进程信号
+ `killall [选项][信号] 进程名`
    + `-i`:交互式,询问是否要杀死某个进程
    + `-I`:忽略进程名的大小写
+ `pkill [选项][信号] 进程名`
    + `-t`:终端号,按照终端号踢掉用户
    + 用`w`命令查看本机已经登录的用户
    + `pkill -9 -t pts/1`

### 修改进程优先级
+ Linux操作系统是一个多用户做任务的操作系统,Linux系统中通知运行着非常多的进程,但是CPU的每一个核心在同一个时钟周期内只能运算一个指令,进程优先级决定了每个进程处理的先后顺序
+ PRI代表PRIORITY,NI代表NICE,这两个值都是优先级,数字越小代表该进程优先级越高。


##### 修改NI值的注意事项
+ NI的值的范围是-20-19
+ 普通用户调整NI值的范围是0-19,而且只能调整自己的进程
+ 普通用户只能调高NI值,而不能降低
+ root用户才能设定进程NI值为负值,而且可以调整任何用户的进程
+ PRI最终值=PRI原始值+NI
+ 用户只能修改NI的值,不能直接修改PRI

##### nice命令
+ `nice [选项] 命令`
+ nice命令可以给新执行的命令直接赋予NI值,但是不能修改硬存在的进程的NI值
+ `-n NI值`:给命令赋予NI值
+ `nice -n 5 service httpd start` 

##### renice命令
+ renice命令是修改已经存在进程的NI值的命令
+ `renice NI值 pid值`
+ `renice -10 2125`

















