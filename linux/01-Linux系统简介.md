#Linux系统简介

+ Linus Torvalds

# 1. linux 系统启动
## 1.1 BIOS
+ 计算机通电后，第一件事就是读取ROM芯片的开机程序，这个程序叫做基本的输入输出系统(Basic Input/Output System)

## 1.2 硬件自检
+ BIOS 程序首先检查，计算机硬件能否满足运行的基本条件，这个叫做硬件自检(Power On Self Test)
+ 如果硬件出现问题，主板会发出不同含义的蜂鸣，启动中止。如果没有问题，屏幕就会显示出 CPU，内存和硬盘等信息。

## 1.3 启动顺序
+ 硬件自检完成后，BIOS 把控制权交给下一阶段的启动程序
+ 这个时候，BIOS 需要知道下一个阶段的启动程序，具体存放在哪一个设备
+ BIOS 需要有一个外部存储设备的排序，排在最前边的设备就是有限转交控制权的设备，这种排序叫做启动顺序(Boot Sequence)
+ BIOS 按照启动程序，把控制权交给排在第一位的存储设备 

## 1.4 主引导记录
+ 计算机读取该设备的第一个扇区，也就是读取最前面的 512 个字节，如果这 512 这字节的最后两个字节是 0X55 和 0XAA，表示这个设备可以用于启动。如果不是，表明设备不能用于启动，控制权于是被转交给启动程序中的下一个设备。
+ 这最前边的 512 个字节，叫做主引导记录(Master Boot Record, MSR)

## 1.5 主引导记录的结构
+ 主引导记录只有512 个字节，它的主要作用是告诉计算机到硬盘的哪个位置去找操作系统
    + 第 1-446 个字节，用来记录系统的启动信息，调用操作系统的机器码
    + 第 447-510字节，一共 64 个字节，是分区表，作用是将硬盘分为若干个区
    + 第 511-512字节，是主引导记录签名(0X55 和 0XAA)

## 1.6 分区表
+ 磁盘分区是使用分区编辑器在磁盘上划分几个逻辑部分
+ 磁盘一旦划分成为多个分区，不同类的目录与文件可以存储进不同的分区内
+ 主引导记录因此必须知道将控制权交给哪个区
+ 分区表的长度只有 64 个字节，里边有分成 4 项，每项 16 个字节，所以，一个硬盘最多只能分为 4 个一级分区，又叫主分区
    + 第 1 个字节，如果为 0x80，就表示该主分区是激活分区，控制权要转交给这个分区，四个主分区里边只能有一个是激活的
    + 第 2-4 个字节，主分区第一个扇区的物理位置(柱面，磁头，扇区号)
    + 第 5 个字节，主分区类型，比如 FAT32，NTFS
    + 第 6-8 个字节，主分区最后一个扇区的物理位置
    + 第 9-12 个字节，主分区的第一个扇区的逻辑地址
    + 第 13-16 个字节，主分区的扇区总数

## 1.7 扇区

+ 扇区是硬盘存储的概念，机械硬盘的内部是金属盘片，将圆形的盘片划分为若干个扇形区域，这就是扇区，若干个扇区就组成了整个盘片。
+ 扇区是硬盘上最小的读写单位，这个是硬盘决定的，不是操作系统决定的。
+ 对现在的硬盘来说，逻辑扇区的大小等于物理扇区的大小，所以没有严格区分物理扇区和逻辑扇区。
+ 物理扇区是底层硬件意义上的扇区
+ 逻辑扇区，在物理扇区之上，操作系统划分的逻辑扇区，是为了方便操作系统读写硬盘数据而设置的，其大小与具体地址，都可以通过一定的公式与物理地址对应。同时如果出现的坏扇区，系统可以通过逻辑扇区，将物理上的坏扇区地址，重新定位到硬盘上备用的好的扇区上，这样就延长了硬盘的使用寿命。

## 1.8 硬盘启动

+ 计算机的控制权要转交给硬盘的某个分区了。
+ 四个主分区里边，只有一个是激活的，计算机会读取激活分区的第一个扇区，叫做卷引导记录(Column Boot Record，VBR)

## 1.9 操作系统

+ 控制权转交给操作系统之后，操作系统的内核首先被载入内存
+ 以 Linux 为例，先载入 /boot 目录下的 kernel，内核加载成功后，第一个运行的程序是 /sbin/init，它根据配置文件产生 init 进程，这是 Linux 启动后的第一个进程， pid 进程编号为 1，其他进程都是它的后代
+ 然后， init 线程加载系统的各个模块，比如窗口程序和网络程序，直至执行 /bin/login 程序，跳出登录界面，等待用户输入用户名和密码

# 2. Linux版本
+ 内核版本
    + Linux核心版本:www.kernel.org
    + 内核版本说明(主版本.次版本.末版本)
+ 发行版本
    + redhat(CentOS):适合于服务器
    + Ubuntu:图形界面,操作方便
    + fedora:个人版本,功能强大
    + debian

## 2.1 开源软件简介
+ Apache,Nginx,MySQL,MongoDB,Ruby,Python,PHP,Sphinx
+ 使用的自由(绝大多数开源软件免费)
+ 研究的自由(可以获得软件源代码)
+ 散布及改良的自由(可以自由传播、改良甚至销售)

## 2.2 Linux应用领域
+ 基于Linux的企业服务器
    + 查看服务器的使用状况: www.netcraft.com
+ 嵌入式应用

## 2.3 Linux学习方法
+ 先尝试自己解决，要自学
    + 查帮助、文档、示例
+ 提问
    + 问题尽量详细，让人可以听懂，并且是具体的知识点
    + 提供详细的报错信息

## 2.4 Linux与Windows的不同
+ Linux严格区分大小写
+ Linux中所有内容以文件形式保存，包括硬件
+ Linux不靠扩展名区分文件类型
    + 压缩包:*.gz, *bz2, *tar.bz2, *.tgz
    + 二进制软件包: *.rpm
    + 网页文件: *.html, *.php
    + 脚本文件: *.sh
    + 配置文件: *.conf
+ Windows下的程序不能直接在Linux中安装和运行

## 2.5 字符界面优势
+ 字符界面占用的系统资源更少
+ 字符界面减少了出错，被攻击的可能性
+ 服务器安全和稳定性优先, 所以一般用字符界面而不会考虑图形界面

# 3. UNIX/LINUX体系结构

## 3.1 内存的管理
+ 内存分配调用：包括静态分配方式，动态分配方式。
+ 内存保护：确保每个程序都在自己的内存空间运行，互不干扰。方法是使用界限寄存器或存储保护键。
+ 地址映射：实现程序的逻辑地址与存储器的物理地址之间的映射功能。
+ 内存扩充，从逻辑上扩充物理内存，以允许比物理内存更大的程序在机器内运行，为此操作系统必须具有：请求调入功能与置换功能。

## 3.2 进程的管理
+ 进程控制：包括进程创建，进程撤销，进程阻塞，进程唤醒。
+ 进程协调：由于进程运行的异步性，因此进程同步的任务是对诸多的运行协调，包括两种方式：进程互斥方式与进程同步方式。
+ 进程通信：主要完成同一台机器上不同进程间通信和不同机器上进程间的通信，以共同完成一相同的任务。
+ 进程调度：操作系统按照一定的规则对等待运行的多道程序进行调度，以保证每个程序都能有机会得到运行，并最终完成。

## 3.3 文件的管理
+ 文件存储空间的管理：为每一个文件分配必要的外存空间。为提高外部存储空间的利用率，系统应设置相应的数据结构，用于记录文件存储空间的使用情况。
+ 目录管理：为了方便对用户的文件进行管理，对文件系统建立一定结构的目录结构，同时要求快速的目录查询手段。
+ 文件的读，写管理和存取控制：利用一定的系统调用对文件进行读写操作。同时，为防止系统中的文件被非法访问和窃取，文件系统中必须提供有效存取的控制功能。

## 3.4 设备管理
+ 缓冲管理：管理各种类型的缓冲区，如字符缓冲区和块缓冲区，以缓和CPU和I/O速度不匹配的矛盾，最终达到提高CPU和I/O设备的利用率，进而提高系统吞吐量的目的。
+ 设备分配：根据用户的I/O请求，为之分配其所需要的设备。
+ 设备处理：又称为设备驱动程序，任务是实现CPU和设备控制器之间的通信。
+ 设备独立性和虚拟设备：一方面保证用户程序独立于物理设备，另一方面保证多个进程能并发地共享同一个设备。
